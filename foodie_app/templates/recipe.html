<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{recipe.name}}</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script&display=swap" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <script src="{% static 'js/app.js' %}"></script> 
</head>
<body class="body">
    <header id="header" class="bg-white d-flex p-3 align-items-center shadow-sm mt-0">
        <h2 class="pr-5 mb-0"><a href="/home" class="home">Foodie Favs</a></h2>
        <a href="/home/new_recipe" class="new-recipe p-1 rounded ml-auto mr-2">+ Recipe</a>
        <a href="/home/{{user.id}}" class="icon rounded p-1">My Profile</a>
        <a href="/home/log_off" class="btn ml-2 p-1" id="log-off">Log Off</a>
    </header>
    <button id="topBtn" title="Go to top" class="btn rounded shadow">Top</button>
    <div class="pt-5"></div>
    <div class="w-50 shadow-sm mt-5 p-4 ml-auto mr-auto rounded recipe-card">
        <h2 class="text-center">{{recipe.name}}</h2>
        <p class="text-center">{{recipe.desc}}</p>
        <div class="pl-4 pr-4 pt-1 pb-2">
            <p class="font-weight-bold">Ingredients:</p class="font-weight-bold">
            <p>{{recipe.ingredients}}</p>
            <p class="font-weight-bold">Steps:</p class="font-weight-bold">
            <p>{{recipe.steps}}</p>
            <p>Recipe added by: {{recipe.creator.first_name}} {{recipe.creator.last_name}}</p>
            <a href="{{recipe.source}}">{{recipe.source}}</a>
            <div class="d-flex">
                {% if recipe.creator.id == user.id %}
                <form action="/home/delete_recipe" method="POST">
                    {% csrf_token %}
                    <input type="hidden" name="recipe_id" value="{{ recipe.id }}">
                    <input class="btn btn-danger p-1 mr-2" type="submit" name="delete" value="Delete">
                </form>
                <form action="/home/edit_{{recipe.id}}" method="POST">
                    {% csrf_token %}
                    <input type="hidden" name="recipe_id" value="{{ recipe.id }}">
                    <input class="btn btn-secondary p-1 pl-2 pr-2" type="submit" name="edit" value="Edit">
                </form>
                {% endif %}
                {% for favorite_user in recipe.users_who_favorite.all %}
                <form action="/home/remove_favorite" method="POST">
                    {% csrf_token %}
                    <input type="hidden" name="recipe_id" value="{{ recipe.id }}">
                    <input type="hidden" name="user_id" value="{{ user.id }}">
                    <input class="btn favorite ml-2 pt-1 pb-1" type="submit" name="add_fav" value="Remove from Favorites">
                </form>
                {% endfor %}
            {% if not user in recipe.users_who_favorite.all %}
            <form class="mt-0 mb-1" action="/home/add_favorite" method="POST">
                {% csrf_token %}
                <input type="hidden" name="recipe_id" value="{{ recipe.id }}">
                <input type="hidden" name="user_id" value="{{ user.id }}">
                <input class="btn favorite ml-2 pt-1 pb-1" type="submit" name="add_fav" value="Add to Favorites">
            </form>
            {% endif %}
            </div>
            
        </div>
        
    </div>
</body>
</html>